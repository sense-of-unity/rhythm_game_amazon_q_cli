# リズムゲーム仕様書

## 1. 概要

### 1.1 ゲーム概要
本ゲームは音楽のリズムに合わせてプレイヤーが操作を行い、タイミングの正確さによって得点を競うリズムゲームである。

### 1.2 対象プラットフォーム
- PC（Windows/Mac）

## 2. ゲームシステム

### 2.1 基本ゲームプレイ
- プレイヤーは音楽のリズムに合わせて画面上に表示される指示に従って操作を行う
- 操作のタイミングと正確さによって得点が決まる
- 一曲のプレイ終了後に総合評価が表示される

### 2.2 操作方法
以下の操作タイプをキーボードでサポート：
1. **キープレス**: 指定されたキー（A, S, D, F, J, K, L, ;など）を押す
2. **ホールド**: 指定されたキーを一定時間押し続ける
3. **同時押し**: 複数のキーを同時に押す
4. **連打**: 同じキーを短時間で複数回押す

### 2.3 判定システム
タイミング判定は以下の5段階：
- **PERFECT**: 理想的なタイミング（±0.03秒以内）- 100点
- **GREAT**: 良好なタイミング（±0.05秒以内）- 80点
- **GOOD**: 許容範囲内のタイミング（±0.10秒以内）- 50点
- **BAD**: 許容範囲外のタイミング（±0.15秒以内）- 20点
- **MISS**: 完全に外れたタイミングまたは未入力 - 0点

### 2.4 コンボシステム
- 連続して成功（GOOD以上）すると「コンボ」としてカウント
- コンボ数に応じて得点倍率が上昇（最大2.0倍）
- BADまたはMISSでコンボが途切れる

## 3. 音楽システム

### 3.1 音楽再生機能
- バックグラウンドで音楽を再生
- 音楽データはOGG形式またはMP3形式をサポート
- 音楽の再生速度を変更可能（0.75倍～1.5倍）

### 3.2 ビート検出と同期
- 各楽曲のBPM（Beats Per Minute）情報を事前に設定
- ノーツ（操作指示）は楽曲のビートに合わせて配置
- システムは音楽の再生位置とノーツの表示タイミングを常に同期

### 3.3 音響効果
- 操作成功時に効果音を再生
- 判定結果に応じて異なる効果音を使用
- 効果音の音量は音楽とは別に調整可能

## 4. ビジュアルシステム

### 4.1 ノーツデザイン
- 各操作タイプに対応した視覚的に区別しやすいノーツデザイン
- キープレス: 対応するキーの文字が表示された円形
- ホールド: 対応するキーの文字が表示された長方形（長さは押し続ける時間を表す）
- 同時押し: 複数のキーが連結された形状
- 連打: 対応するキーの文字と連打回数が表示された特殊アイコン

### 4.2 判定ライン
- 画面上に判定ラインを表示
- ノーツがこのラインに到達したタイミングで操作を行うのが理想的
- 判定結果に応じてエフェクトを表示

### 4.3 背景演出
- 音楽のビートや盛り上がりに合わせて背景エフェクトを変化
- プレイヤーの操作成功率に応じて背景の演出を変化

## 5. 難易度システム

### 5.1 難易度レベル
以下の4段階の難易度を用意：
- **EASY**: 初心者向け、基本的な操作のみ
- **NORMAL**: 中級者向け、基本操作に加えて簡単な複合操作
- **HARD**: 上級者向け、複雑な操作パターンと高速なテンポ
- **EXPERT**: 熟練者向け、極めて複雑かつ高速な操作要求

### 5.2 難易度調整要素
- ノーツの数と密度
- 複合操作の頻度
- 判定の厳しさ（オプションで調整可能）

## 6. スコアシステム

### 6.1 得点計算
基本得点 = ノーツの判定点 × コンボ倍率
総合得点 = 基本得点の合計 + ボーナス点

### 6.2 ランク評価
プレイ終了時に以下のランクを表示：
- **S**: 95%以上の精度
- **A**: 90%以上の精度
- **B**: 80%以上の精度
- **C**: 70%以上の精度
- **D**: 60%以上の精度
- **E**: 60%未満の精度

### 6.3 リザルト画面
- 総合得点
- 最大コンボ数
- 各判定の回数（PERFECT, GREAT, GOOD, BAD, MISS）
- 精度（%）
- ランク評価

## 7. 楽曲選択システム

### 7.1 楽曲リスト
- ジャンル別に楽曲を分類
- 難易度別にフィルタリング可能
- お気に入り登録機能

### 7.2 楽曲情報表示
- 曲名とアーティスト
- 曲の長さ
- BPM
- 各難易度のレベル表示
- 自己ベストスコアとランク

## 8. カスタマイズ機能

### 8.1 ゲーム設定
- 音量調整（BGM、効果音）
- ノーツの落下速度調整
- 判定タイミングオフセット調整
- キーボードのキー配置カスタマイズ
- キーボード入力感度調整

### 8.2 視覚カスタマイズ
- ノーツのスキン変更
- 背景テーマ変更
- 判定エフェクト変更

## 9. 技術要件

### 9.1 フレームレート
- 最低60FPS以上を維持
- 120FPSにも対応（ハイエンド端末向け）

### 9.2 入力遅延
- キーボード入力遅延は10ms以下を目標
- キー入力からシステム認識までの遅延を最小化
- 各種キーボードの特性に合わせた入力遅延補正機能

### 9.3 音声同期
- 音声と視覚要素の同期ずれは±10ms以内に抑える
- デバイスごとの音声遅延を自動補正する機能を実装

## 10. 将来拡張計画

### 10.1 マルチプレイヤー機能
- リアルタイム対戦モード
- ランキングシステム

### 10.2 追加コンテンツ
- 定期的な楽曲追加
- 季節イベント
- 限定スキン

## 11. 開発スケジュール

### 11.1 フェーズ1: 基本システム開発
- 音楽再生エンジン
- 基本操作システム
- 判定システム

### 11.2 フェーズ2: コンテンツ制作
- 楽曲データ作成
- ノーツ配置
- ビジュアルデザイン

### 11.3 フェーズ3: テストと最適化
- パフォーマンス最適化
- バランス調整
- ユーザーテスト

## 12. 付録

### 12.1 用語集
- **ノーツ**: プレイヤーが操作すべき対象
- **BPM**: Beats Per Minute、曲のテンポを表す単位
- **判定**: プレイヤーの操作タイミングの評価
- **コンボ**: 連続成功回数

### 12.2 参考資料
- 競合製品分析
- ユーザーフィードバック要約
- 技術的制約と解決策
## 13. キーボードレイアウトと操作方法

### 13.1 デフォルトキー配置
- メインキー: A, S, D, F, J, K, L, ;（左右の手で4キーずつ）
- 特殊キー: Space（特殊アクション用）
- メニュー操作: 矢印キー、Enter、Esc

### 13.2 キーボード操作ガイドライン
- 初心者向けレイアウト: 4キー（D, F, J, K）
- 中級者向けレイアウト: 6キー（S, D, F, J, K, L）
- 上級者向けレイアウト: 8キー（A, S, D, F, J, K, L, ;）
- キー配置は完全にカスタマイズ可能

### 13.3 キーボード操作のUI表示
- 画面下部にキーボードのバーチャル表示
- 対応するキーとノーツの色を一致させる
- キー押下時の視覚フィードバック
- キーごとの判定結果の即時表示
