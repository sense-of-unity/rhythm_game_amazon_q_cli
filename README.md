# リズムゲーム

仕様書 `rhythm_game_specification.md` に基づいて実装されたPyGameによるリズムゲームです。

## 概要

このゲームは音楽のリズムに合わせてキーボードのキーを押すシンプルなリズムゲームです。
画面上部から落ちてくるノーツが判定ラインに到達したタイミングでキーを押すことで得点を獲得します。

## 操作方法

- **D, F, J, K キー**: 各レーンのノーツを叩く
- **スペースキー**: ゲーム開始
- **ESCキー**: ゲーム終了
- **Rキー**: リザルト画面からリプレイ

## 判定システム

タイミング判定は以下の5段階：
- **PERFECT**: 理想的なタイミング（±0.03秒以内）- 100点
- **GREAT**: 良好なタイミング（±0.05秒以内）- 80点
- **GOOD**: 許容範囲内のタイミング（±0.10秒以内）- 50点
- **BAD**: 許容範囲外のタイミング（±0.15秒以内）- 20点
- **MISS**: 完全に外れたタイミングまたは未入力 - 0点

## ランク評価

プレイ終了時に以下のランクを表示：
- **S**: 95%以上の精度
- **A**: 90%以上の精度
- **B**: 80%以上の精度
- **C**: 70%以上の精度
- **D**: 60%以上の精度
- **E**: 60%未満の精度

## 実行方法

### 簡単な実行方法
```bash
cd rhythm_game_spec
./run_game.sh
```

### 手動での実行
```bash
cd rhythm_game_spec
python3 rhythm_game.py
```

### 音楽ファイルの変更
```bash
cd rhythm_game_spec
./change_music.py
```

## 必要なライブラリ

- PyGame
- NumPy
- Librosa (ビート検出機能を使用する場合)

インストールされていない場合は以下のコマンドでインストールしてください：

```bash
pip install pygame numpy librosa
```

## 外部ツール (音楽生成用)

音楽を自分で生成する場合は以下のツールが必要です：
- FFmpeg
- SoX (Sound eXchange)

## ファイル構成

- `rhythm_game.py`: ゲームのメインスクリプト
- `rhythm_game_specification.md`: ゲームの仕様書
- `sample_music/`: 音楽ファイルを格納するディレクトリ
- `sounds/`: 効果音ファイルを格納するディレクトリ（初回実行時に自動生成）
- `run_game.sh`: ゲームを簡単に実行するためのスクリプト
- `change_music.py`: 使用する音楽ファイルを変更するスクリプト

## 推奨音楽ファイル

以下の音楽ファイルがゲームプレイに最適です：
- `very_short_jpop.mp3`: メロディとリズムが同期した約3分間の音楽
- `jpop_rhythm_game.mp3`: デフォルトで使用される音楽ファイル

## 注意事項

- 初回実行時に効果音ファイルが自動生成されます
- 音楽ファイルは `sample_music` ディレクトリに配置してください
- デフォルトでは `jpop_rhythm_game.mp3` を使用します
- 音楽ファイルを変更する場合は `change_music.py` を実行してください
- ビート検出機能を使用すると、プレイごとに異なる譜面が生成されます

## GitHub について

このプロジェクトは Amazon Q CLI を使用して作成されました。
コードや音楽生成のプロセスについての詳細は、https://qiita.com/sense_of_unity/items/4ce07c1fd5ec0e003f47をご覧ください。
